# üìã API –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ - –ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

> –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ `/api/register` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤

---

## üìç –≠–Ω–¥–ø–æ–∏–Ω—Ç

```
POST /api/register
```

**–î–æ—Å—Ç—É–ø:**
- **–õ–æ–∫–∞–ª—å–Ω–æ:** `http://localhost:8090/api/register`
- **Ngrok:** `https://your-ngrok-url.ngrok-free.app/api/register`
- **Production:** `https://api.yourdomain.com/api/register`

---

## üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**API –∫–ª—é—á –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù!**

### –ó–∞–≥–æ–ª–æ–≤–∫–∏:

```http
Content-Type: application/json
X-API-Key: dev_api_key_12345
```

| –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –ó–Ω–∞—á–µ–Ω–∏–µ (dev) | –ó–Ω–∞—á–µ–Ω–∏–µ (prod) |
|-----------|--------------|----------------|-----------------|
| `Content-Type` | ‚úÖ –î–∞ | `application/json` | `application/json` |
| `X-API-Key` | ‚úÖ –î–∞ | `dev_api_key_12345` | –í–∞—à PROD –∫–ª—é—á |
| `X-Request-Id` | ‚ùå –ù–µ—Ç | UUID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | UUID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

---

## üì• –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Request Body)

### JSON Schema:

```json
{
  "login": "string",
  "password": "string",
  "gender": 0 | 1,
  "telegram_id": integer,
  "username": "string" (optional)
}
```

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π:

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –í–∞–ª–∏–¥–∞—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|-----------|----------|
| `login` | `string` | ‚úÖ –î–∞ | `3-16` —Å–∏–º–≤–æ–ª–æ–≤ | –ò–º—è –∏–≥—Ä–æ–∫–∞ (—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ) |
| `password` | `string` | ‚úÖ –î–∞ | `6-20` —Å–∏–º–≤–æ–ª–æ–≤ | –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ |
| `gender` | `integer` | ‚úÖ –î–∞ | `0` –∏–ª–∏ `1` | –ü–æ–ª –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: `0` = –º—É–∂—Å–∫–æ–π, `1` = –∂–µ–Ω—Å–∫–∏–π |
| `telegram_id` | `integer` | ‚úÖ –î–∞ | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram |
| `username` | `string` | ‚ùå –ù–µ—Ç | –õ—é–±–∞—è —Å—Ç—Ä–æ–∫–∞ | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

1. **`login`:**
   - –ú–∏–Ω–∏–º—É–º **3 —Å–∏–º–≤–æ–ª–∞**
   - –ú–∞–∫—Å–∏–º—É–º **16 —Å–∏–º–≤–æ–ª–æ–≤**
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–º** (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –ë–î)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∏–≥—Ä—É

2. **`password`:**
   - –ú–∏–Ω–∏–º—É–º **6 —Å–∏–º–≤–æ–ª–æ–≤**
   - –ú–∞–∫—Å–∏–º—É–º **20 —Å–∏–º–≤–æ–ª–æ–≤**
   - –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ game server –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞

3. **`gender`:**
   - –¢–æ–ª—å–∫–æ `0` (–º—É–∂—Å–∫–æ–π) –∏–ª–∏ `1` (–∂–µ–Ω—Å–∫–∏–π)
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–æ–¥–µ–ª—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –∏–≥—Ä–µ

4. **`telegram_id`:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
     - –ü—Ä–æ–≤–µ—Ä–∫–∏ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ Telegram –≥—Ä—É–ø–ø–µ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
     - –õ–∏–º–∏—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π (–º–∞–∫—Å–∏–º—É–º **5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤** –Ω–∞ 1 Telegram ID)
   - –ü–æ–ª—É—á–∏—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ [@userinfobot](https://t.me/userinfobot)

5. **`username`:**
   - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)

---

## ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

### HTTP Status: `200 OK`

```json
{
  "ok": true,
  "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!",
  "request_id": "uuid-string-or-null"
}
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:

1. ‚úÖ –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ –ë–î (`MySQL ‚Üí players`)
2. ‚úÖ –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–≤—è–∑—å `telegram_id ‚Üî player_id`
3. ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ **game server** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
4. ‚úÖ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å Redis –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## ‚ùå –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫:

| HTTP Status | `detail` | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|-------------|----------|---------|---------|
| **400** | `Bad Request` | –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON –∏–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É JSON |
| **400** | `bad_request` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –ø–æ–ª—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º |
| **403** | `invalid_api_key` | API –∫–ª—é—á –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π | –ü–µ—Ä–µ–¥–∞–π—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `X-API-Key` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ |
| **403** | `limit_exceeded` | –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ **5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤** | –£–¥–∞–ª–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π Telegram ID |
| **403** | `not_in_telegram_group` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π Telegram –≥—Ä—É–ø–ø–µ | –í—Å—Ç—É–ø–∏—Ç–µ –≤ –≥—Ä—É–ø–ø—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ |
| **409** | `login_taken` | –õ–æ–≥–∏–Ω —É–∂–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º | –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π –ª–æ–≥–∏–Ω |
| **422** | Validation Error | –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª–µ–π (Pydantic) | –°–º. –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –≤ `detail` |
| **429** | Too Many Requests | –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (**10 req/min**) | –ü–æ–¥–æ–∂–¥–∏—Ç–µ –º–∏–Ω—É—Ç—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ |
| **500** | `internal_error` | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É |
| **502** | `game_server error: ...` | –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ game server | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ game server –¥–æ—Å—Ç—É–ø–µ–Ω |
| **502** | `unexpected_error: ...` | –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ | –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É |
| **503** | `service unavailable` | –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ |

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫ (–¥–µ—Ç–∞–ª—å–Ω–æ)

### 1Ô∏è‚É£ **400 Bad Request** - –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST http://localhost:8090/api/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: dev_api_key_12345" \
  -d '{invalid json'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "detail": "Bad Request"
}
```

---

### 2Ô∏è‚É£ **403 Forbidden** - –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST http://localhost:8090/api/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: wrong_key" \
  -d '{...}'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "error": "invalid_api_key",
  "message": "API key is missing or invalid"
}
```

---

### 3Ô∏è‚É£ **403 Forbidden** - –õ–∏–º–∏—Ç –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏—Å—á–µ—Ä–ø–∞–Ω

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "login": "Player6",
  "password": "pass123",
  "gender": 0,
  "telegram_id": 123456789
}
```

**–û—Ç–≤–µ—Ç (–µ—Å–ª–∏ —É `telegram_id: 123456789` —É–∂–µ –µ—Å—Ç—å 5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤):**
```json
{
  "detail": "limit_exceeded"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:** 
- –ö–∞–∂–¥–æ–º—É Telegram –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –º–∞–∫—Å–∏–º—É–º **5 –∏–≥—Ä–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤**
- –≠—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –£–¥–∞–ª–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π Telegram –∞–∫–∫–∞—É–Ω—Ç

---

### 4Ô∏è‚É£ **403 Forbidden** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ Telegram –≥—Ä—É–ø–ø–µ

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "login": "NewPlayer",
  "password": "pass123",
  "gender": 1,
  "telegram_id": 999999999
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "detail": "not_in_telegram_group"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ Telegram –≥—Ä—É–ø–ø–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å `telegram_id: 999999999` –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –≥—Ä—É–ø–ø–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –í—Å—Ç—É–ø–∏—Ç–µ –≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é Telegram –≥—Ä—É–ø–ø—É
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã (–∫–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- –≠—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ **–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞**
- –í–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `TELEGRAM_BOT_TOKEN` –∏ `TELEGRAM_REQUIRED_GROUP_ID` –≤ `.env`
- –ü–æ–¥—Ä–æ–±–Ω–µ–µ: [TELEGRAM_GROUP_CHECK.md](TELEGRAM_GROUP_CHECK.md)

---

### 5Ô∏è‚É£ **409 Conflict** - –õ–æ–≥–∏–Ω —É–∂–µ –∑–∞–Ω—è—Ç

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "login": "ExistingPlayer",
  "password": "newpass",
  "gender": 0,
  "telegram_id": 111111111
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "detail": "login_taken"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –õ–æ–≥–∏–Ω `ExistingPlayer` —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
- –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π –ª–æ–≥–∏–Ω

---

### 6Ô∏è‚É£ **422 Unprocessable Entity** - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ó–∞–ø—Ä–æ—Å (–ø–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π):**
```json
{
  "login": "Player",
  "password": "123",
  "gender": 0,
  "telegram_id": 123456789
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "detail": [
    {
      "type": "string_too_short",
      "loc": ["body", "password"],
      "msg": "String should have at least 6 characters",
      "input": "123",
      "ctx": {
        "min_length": 6
      }
    }
  ]
}
```

**–î—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

| –û—à–∏–±–∫–∞ | –ü–æ–ª–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|--------|------|---------|
| `string_too_short` | `login` | –õ–æ–≥–∏–Ω < 3 —Å–∏–º–≤–æ–ª–æ–≤ |
| `string_too_long` | `login` | –õ–æ–≥–∏–Ω > 16 —Å–∏–º–≤–æ–ª–æ–≤ |
| `string_too_short` | `password` | –ü–∞—Ä–æ–ª—å < 6 —Å–∏–º–≤–æ–ª–æ–≤ |
| `string_too_long` | `password` | –ü–∞—Ä–æ–ª—å > 20 —Å–∏–º–≤–æ–ª–æ–≤ |
| `less_than_equal` | `gender` | `gender < 0` |
| `greater_than_equal` | `gender` | `gender > 1` |
| `int_parsing` | `telegram_id` | –ù–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ |
| `missing` | `login` | –ü–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |

---

### 7Ô∏è‚É£ **429 Too Many Requests** - Rate Limiting

**–ó–∞–ø—Ä–æ—Å (11-–π –∑–∞–ø—Ä–æ—Å –∑–∞ –º–∏–Ω—É—Ç—É):**
```bash
curl -X POST http://localhost:8090/api/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: dev_api_key_12345" \
  -d '{...}'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "detail": "Too Many Requests"
}
```

**–õ–∏–º–∏—Ç—ã:**
- **10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É** —Å –æ–¥–Ω–æ–≥–æ IP
- **Burst:** –¥–æ 3 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤—Å–µ–≥–æ 13)
- –ü–æ—Å–ª–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 1 –º–∏–Ω—É—Ç—É

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 60 —Å–µ–∫—É–Ω–¥
- –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥

---

### 8Ô∏è‚É£ **502 Bad Gateway** - –û—à–∏–±–∫–∞ game server

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "login": "Player",
  "password": "pass123",
  "gender": 0,
  "telegram_id": 123456789
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "detail": "game_server error: Connection refused"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- Game server –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –ù–µ–≤–µ—Ä–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å game server

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å

**cURL:**
```bash
curl -X POST http://localhost:8090/api/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: dev_api_key_12345" \
  -d '{
    "login": "Player1",
    "password": "mypass123",
    "gender": 0,
    "telegram_id": 123456789
  }'
```

**JavaScript (fetch):**
```javascript
fetch('http://localhost:8090/api/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'dev_api_key_12345'
  },
  body: JSON.stringify({
    login: 'Player1',
    password: 'mypass123',
    gender: 0,
    telegram_id: 123456789
  })
})
.then(res => res.json())
.then(data => console.log(data));
```

**Python:**
```python
import requests

response = requests.post(
    'http://localhost:8090/api/register',
    headers={
        'Content-Type': 'application/json',
        'X-API-Key': 'dev_api_key_12345'
    },
    json={
        'login': 'Player1',
        'password': 'mypass123',
        'gender': 0,
        'telegram_id': 123456789
    }
)

print(response.json())
```

---

### ‚úÖ –ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—Å–æ –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏)

**cURL:**
```bash
curl -X POST http://localhost:8090/api/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: dev_api_key_12345" \
  -H "X-Request-Id: $(uuidgen)" \
  -d '{
    "login": "Player1",
    "password": "mypass123",
    "gender": 1,
    "telegram_id": 123456789,
    "username": "@player1_tg"
  }'
```

**JavaScript (—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π UUID):**
```javascript
const requestId = crypto.randomUUID();

fetch('http://localhost:8090/api/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'dev_api_key_12345',
    'X-Request-Id': requestId
  },
  body: JSON.stringify({
    login: 'Player1',
    password: 'mypass123',
    gender: 1,
    telegram_id: 123456789,
    username: '@player1_tg'
  })
})
.then(async res => {
  if (!res.ok) {
    const error = await res.json();
    throw new Error(error.detail);
  }
  return res.json();
})
.then(data => {
  console.log('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!', data);
})
.catch(error => {
  console.error('‚ùå –û—à–∏–±–∫–∞:', error.message);
});
```

---

## üîç –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (Best Practices)

### JavaScript –ø—Ä–∏–º–µ—Ä —Å –ø–æ–ª–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π:

```javascript
async function registerUser(login, password, gender, telegramId) {
  try {
    const response = await fetch('http://localhost:8090/api/register', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-API-Key': 'dev_api_key_12345'
      },
      body: JSON.stringify({
        login,
        password,
        gender,
        telegram_id: telegramId
      })
    });

    const data = await response.json();

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
    if (response.ok) {
      return {
        success: true,
        message: data.message
      };
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö –æ—à–∏–±–æ–∫
    switch (data.detail) {
      case 'invalid_api_key':
        return {
          success: false,
          message: '–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.'
        };

      case 'login_taken':
        return {
          success: false,
          message: '–≠—Ç–æ—Ç –ª–æ–≥–∏–Ω —É–∂–µ –∑–∞–Ω—è—Ç. –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π.'
        };

      case 'limit_exceeded':
        return {
          success: false,
          message: '–í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (5).'
        };

      case 'not_in_telegram_group':
        return {
          success: false,
          message: '–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å –≤ Telegram –≥—Ä—É–ø–ø–µ.'
        };

      default:
        // –í–∞–ª–∏–¥–∞—Ü–∏—è Pydantic (422)
        if (Array.isArray(data.detail)) {
          const errors = data.detail.map(err => err.msg).join(', ');
          return {
            success: false,
            message: `–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${errors}`
          };
        }

        return {
          success: false,
          message: `–û—à–∏–±–∫–∞: ${data.detail}`
        };
    }

  } catch (error) {
    return {
      success: false,
      message: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.'
    };
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const result = await registerUser('Player1', 'mypass123', 0, 123456789);

if (result.success) {
  alert(result.message);  // "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!"
} else {
  alert(result.message);  // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
}
```

---

## üìä Workflow —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST /api/register                    ‚îÇ
‚îÇ    + JSON —Å login, password, gender, telegram_id            ‚îÇ
‚îÇ    + X-API-Key –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. Nginx Proxy –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:                                   ‚îÇ
‚îÇ    ‚úì API –∫–ª—é—á –≤–∞–ª–∏–¥–Ω—ã–π?                                     ‚îÇ
‚îÇ    ‚úì Rate limit –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω?                                ‚îÇ
‚îÇ    ‚úì CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. API_Father (FastAPI) –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç:                         ‚îÇ
‚îÇ    ‚úì JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞?                              ‚îÇ
‚îÇ    ‚úì –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –µ—Å—Ç—å?                            ‚îÇ
‚îÇ    ‚úì –ó–Ω–∞—á–µ–Ω–∏—è –≤ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö?                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. Business Logic –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:                                ‚îÇ
‚îÇ    ‚úì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ Telegram –≥—Ä—É–ø–ø–µ? (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)        ‚îÇ
‚îÇ    ‚úì –£ telegram_id < 5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤?                           ‚îÇ
‚îÇ    ‚úì –õ–æ–≥–∏–Ω —Å–≤–æ–±–æ–¥–µ–Ω?                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞:                                       ‚îÇ
‚îÇ    ‚úì –ó–∞–ø–∏—Å—å –≤ MySQL (players, telegram_players)             ‚îÇ
‚îÇ    ‚úì –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ game server (socket)                       ‚îÇ
‚îÇ    ‚úì (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –û—á–µ—Ä–µ–¥—å Redis                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 6. –û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É:                                           ‚îÇ
‚îÇ    {"ok": true, "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!"}          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîß –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Telegram ID

### –ú–µ—Ç–æ–¥ 1: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ—Ç–∞ [@userinfobot](https://t.me/userinfobot)

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ `@userinfobot`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. –ë–æ—Ç –≤–µ—Ä–Ω–µ—Ç –≤–∞—à ID:

```
Id: 123456789
First: John
...
```

### –ú–µ—Ç–æ–¥ 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JavaScript –≤ Telegram Web App

```javascript
// –í Telegram Mini App
const user = Telegram.WebApp.initDataUnsafe.user;
console.log(user.id);  // 123456789
```

### –ú–µ—Ç–æ–¥ 3: –ü–æ–ª—É—á–∏—Ç–µ —á–µ—Ä–µ–∑ API

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ YOUR_BOT_TOKEN
curl https://api.telegram.org/botYOUR_BOT_TOKEN/getUpdates
```

---

## üßë‚Äçüíª –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç–µ (–ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä)

### HTML —Ñ–æ—Ä–º–∞:

```html
<form id="registerForm">
  <input type="text" id="login" placeholder="–õ–æ–≥–∏–Ω (3-16 —Å–∏–º–≤–æ–ª–æ–≤)" required>
  <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å (6-20 —Å–∏–º–≤–æ–ª–æ–≤)" required>
  
  <select id="gender" required>
    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª --</option>
    <option value="0">–ú—É–∂—Å–∫–æ–π</option>
    <option value="1">–ñ–µ–Ω—Å–∫–∏–π</option>
  </select>
  
  <input type="number" id="telegram_id" placeholder="Telegram ID" required>
  <input type="text" id="username" placeholder="Telegram username (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
  
  <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
</form>

<div id="result"></div>
```

### JavaScript –æ–±—Ä–∞–±–æ—Ç–∫–∞:

```javascript
const API_CONFIG = {
  baseUrl: 'http://localhost:8090',  // –∏–ª–∏ ngrok URL
  apiKey: 'dev_api_key_12345'
};

document.getElementById('registerForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const formData = {
    login: document.getElementById('login').value.trim(),
    password: document.getElementById('password').value,
    gender: parseInt(document.getElementById('gender').value),
    telegram_id: parseInt(document.getElementById('telegram_id').value),
    username: document.getElementById('username').value.trim() || undefined
  };
  
  const resultDiv = document.getElementById('result');
  resultDiv.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...';
  
  try {
    const response = await fetch(`${API_CONFIG.baseUrl}/api/register`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-API-Key': API_CONFIG.apiKey
      },
      body: JSON.stringify(formData)
    });
    
    const data = await response.json();
    
    if (response.ok) {
      resultDiv.innerHTML = `<span style="color: green;">‚úÖ ${data.message}</span>`;
      document.getElementById('registerForm').reset();
    } else {
      // –ß–∏—Ç–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
      const errorMessages = {
        'login_taken': '–õ–æ–≥–∏–Ω —É–∂–µ –∑–∞–Ω—è—Ç',
        'limit_exceeded': '–î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (5 –Ω–∞ Telegram ID)',
        'not_in_telegram_group': '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å—Ç—É–ø–∏—Ç—å –≤ Telegram –≥—Ä—É–ø–ø—É',
        'invalid_api_key': '–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏'
      };
      
      const errorMsg = errorMessages[data.detail] || data.detail;
      resultDiv.innerHTML = `<span style="color: red;">‚ùå ${errorMsg}</span>`;
    }
    
  } catch (error) {
    resultDiv.innerHTML = `<span style="color: red;">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏</span>`;
    console.error(error);
  }
});
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](QUICKSTART.md)
- [Production Setup](PRODUCTION_SETUP.md)
- [Ngrok —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](NGROK_TESTING.md)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∞–π—Ç–æ–º](API_FOR_WEBSITE.md)
- [Telegram Group Check](TELEGRAM_GROUP_CHECK.md)
- [–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤](ENDPOINTS.md)

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

- [ ] –ü–æ–ª—É—á–∏–ª API –∫–ª—é—á (`dev_api_key_12345` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- [ ] –ó–Ω–∞—é —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ (JSON —Å 4 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏)
- [ ] –î–æ–±–∞–≤–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö –∫–æ–¥–æ–≤ –æ—à–∏–±–æ–∫
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª rate limiting
- [ ] –î–æ–±–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ (3-16 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ª–æ–≥–∏–Ω–∞, 6-20 –¥–ª—è –ø–∞—Ä–æ–ª—è)
- [ ] –î–æ–±–∞–≤–∏–ª –ø—Ä–æ–≤–µ—Ä–∫—É Telegram ID
- [ ] –°–æ–∑–¥–∞–ª —á–∏—Ç–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —Å ngrok (–µ—Å–ª–∏ —Å–∞–π—Ç –ø—É–±–ª–∏—á–Ω—ã–π)

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–º. [API_FOR_WEBSITE.md](API_FOR_WEBSITE.md) –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.



