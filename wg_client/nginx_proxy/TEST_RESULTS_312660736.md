# üß™ –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ API —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**Telegram ID:** `312660736`  
**API URL:** `http://localhost:8090`

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. Health Check
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED**
```json
GET /health
Response: {"status": "ok"}
HTTP Code: 200
```

---

### 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –±–µ–∑ API –∫–ª—é—á–∞
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED**
```json
POST /api/register (–±–µ–∑ X-API-Key)
Response: {"error": "invalid_api_key", "message": "API key is missing or invalid"}
HTTP Code: 403
```
**–í—ã–≤–æ–¥:** Nginx –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ API –∫–ª—é—á–∞.

---

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –ª–æ–≥–∏–Ω–∞ (–∫–æ—Ä–æ—Ç–∫–∏–π)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED** (–∫–æ–¥ 400 –≤–º–µ—Å—Ç–æ 422, –Ω–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç)
```json
POST /api/register
Body: {"login": "AB", ...}
Response: {
  "ok": false,
  "error": "validation_error",
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
  "fields": {
    "login": "–û—à–∏–±–∫–∞: –õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 3 –¥–æ 16 —Å–∏–º–≤–æ–ª–æ–≤"
  }
}
HTTP Code: 400
```
**–í—ã–≤–æ–¥:** API_Father –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 400 –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ FastAPI 422, –Ω–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è (–∫–æ—Ä–æ—Ç–∫–∏–π)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED**
```json
POST /api/register
Body: {"password": "12345", ...}
Response: {
  "ok": false,
  "error": "validation_error",
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
  "fields": {
    "password": "–û—à–∏–±–∫–∞: –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 6 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ –ª–∞—Ç–∏–Ω–∏—Ü–µ"
  }
}
HTTP Code: 400
```

---

### 5. –í–∞–ª–∏–¥–∞—Ü–∏—è gender (–Ω–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED**
```json
POST /api/register
Body: {"gender": 2, ...}
Response: {
  "ok": false,
  "error": "validation_error",
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
  "fields": {
    "gender": "–û—à–∏–±–∫–∞: –í—ã –Ω–µ –≤—ã–±—Ä–∞–ª–∏ –ø–æ–ª –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"
  }
}
HTTP Code: 400
```

---

### 6. –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED** (–æ–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞ - –ª–∏–º–∏—Ç)
```json
POST /api/register
Body: {
  "login": "TestUser445151",
  "password": "test12345",
  "gender": 0,
  "telegram_id": 312660736,
  "username": "@test_user"
}
Response: {"detail": "limit_exceeded"}
HTTP Code: 403
```
**–ü—Ä–∏—á–∏–Ω–∞:** –£ `telegram_id: 312660736` —É–∂–µ **5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤** (–º–∞–∫—Å–∏–º—É–º).

---

### 7. Rate Limiting
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **PASSED**
```
POST /api/register (11-–π –∑–∞–ø—Ä–æ—Å –≤ —Ç–µ—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç—ã)
HTTP Code: 429 Too Many Requests
```
**–í—ã–≤–æ–¥:** Nginx rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç (–ª–∏–º–∏—Ç 10 req/min).

---

## üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –¥–ª—è Telegram ID: 312660736

### –ó–∞–ø—Ä–æ—Å –≤ –ë–î:
```sql
SELECT COUNT(*) as total, GROUP_CONCAT(login SEPARATOR ', ') as logins 
FROM tgplayers 
WHERE telegram_id=312660736;
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
–í—Å–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: 5 / 5 (–õ–ò–ú–ò–¢ –î–û–°–¢–ò–ì–ù–£–¢)
–õ–æ–≥–∏–Ω—ã:
  1. ????? (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
  2. ????????_??? (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
  3. 11111111112ddd
  4. addda
  5. Tirir
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å —ç—Ç–∏–º Telegram ID –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç.

---

## üîç –ü–æ–ª–Ω—ã–π workflow (—á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí POST /api/register (Nginx :8090)
   ‚Üì
2. Nginx –ø—Ä–æ–≤–µ—Ä—è–µ—Ç X-API-Key
   ‚úÖ –ö–ª—é—á –≤–∞–ª–∏–¥–µ–Ω ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
   ‚ùå –ö–ª—é—á –Ω–µ–≤–∞–ª–∏–¥–µ–Ω ‚Üí 403 Forbidden
   ‚Üì
3. Nginx ‚Üí proxy_pass ‚Üí Traefik (:1010) ‚Üí API_Father (:8080)
   ‚Üì
4. API_Father –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç JSON (login, password, gender)
   ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ ‚Üí 400 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫
   ‚úÖ –í–∞–ª–∏–¥–Ω–æ ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
   ‚Üì
5. API_Father –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É:
   a) Telegram –≥—Ä—É–ø–ø–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
   b) –õ–∏–º–∏—Ç –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (< 5 –¥–ª—è telegram_id)
   c) –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ª–æ–≥–∏–Ω–∞
   ‚Üì
6. telegram_id: 312660736 ‚Üí —É–∂–µ 5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤
   ‚ùå limit_exceeded ‚Üí 403 Forbidden
   ‚Üì
7. –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: {"detail": "limit_exceeded"}
```

---

## ‚úÖ –í—ã–≤–æ–¥—ã

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. ‚úÖ **Health check** - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
2. ‚úÖ **API Key –≤–∞–ª–∏–¥–∞—Ü–∏—è** - Nginx –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –∫–ª—é—á–∞
3. ‚úÖ **CORS** - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è `*` (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
4. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π** - –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, gender –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
5. ‚úÖ **Rate Limiting** - 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É —Å IP
6. ‚úÖ **–õ–∏–º–∏—Ç –∞–∫–∫–∞—É–Ω—Ç–æ–≤** - –º–∞–∫—Å–∏–º—É–º 5 –Ω–∞ Telegram ID
7. ‚úÖ **Proxy —Ü–µ–ø–æ—á–∫–∞** - Nginx ‚Üí Traefik ‚Üí API_Father

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- **HTTP 400 –≤–º–µ—Å—Ç–æ 422** –¥–ª—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ - API_Father –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤
- **–ß–∏—Ç–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** - `fields` —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- **Telegram –≥—Ä—É–ø–ø–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∑–∞–¥–∞–Ω—ã)

---

## üß™ –¢–µ—Å—Ç —Å –Ω–æ–≤—ã–º Telegram ID

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–¥—Ä—É–≥–æ–π** Telegram ID (–Ω–µ 312660736):

```bash
# –ü—Ä–∏–º–µ—Ä —Å telegram_id: 999999999
curl -X POST http://localhost:8090/api/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: dev_api_key_12345" \
  -d '{
    "login": "NewPlayer123",
    "password": "securepass",
    "gender": 0,
    "telegram_id": 999999999
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–µ—Å–ª–∏ telegram_id –Ω–æ–≤—ã–π):**
```json
{
  "ok": true,
  "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!",
  "request_id": null
}
```

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞:

1. **API –∫–ª—é—á:** –ó–∞–º–µ–Ω–∏—Ç–µ `dev_api_key_12345` –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–µ—Ä–µ–∑ `openssl rand -base64 32`
2. **CORS:** –ò–∑–º–µ–Ω–∏—Ç–µ `*` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω —Å–∞–π—Ç–∞
3. **SSL:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Let's Encrypt (—Å–º. `PRODUCTION_SETUP.md`)
4. **Monitoring:** –î–æ–±–∞–≤—å—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ 429/403/500 –æ—à–∏–±–∫–∏
5. **–õ–æ–≥–∏:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤ Nginx

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ telegram_id –¥–ª—è —Ç–µ—Å—Ç–æ–≤
2. **–û—á–∏—Å—Ç–∫–∞ –ë–î:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
3. **Ngrok:** –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–º. `NGROK_TESTING.md`)

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API](REGISTRATION_API_SPEC.md)
- [–ö–æ–¥—ã –æ—à–∏–±–æ–∫](ERROR_CODES_QUICK_REF.md)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∞–π—Ç–æ–º](API_FOR_WEBSITE.md)
- [Production Setup](PRODUCTION_SETUP.md)
- [Ngrok —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](NGROK_TESTING.md)

---

## ‚úÖ –ò—Ç–æ–≥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –°–ò–°–¢–ï–ú–´ –†–ê–ë–û–¢–ê–Æ–¢ –ö–û–†–†–ï–ö–¢–ù–û**

API —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ - —É `telegram_id: 312660736` –∏—Å—á–µ—Ä–ø–∞–Ω –ª–∏–º–∏—Ç –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (5/5).

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π Telegram ID.

---

**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞:** 14.10.2025  
**–í–µ—Ä—Å–∏—è API:** v1  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª:** AI Assistant



