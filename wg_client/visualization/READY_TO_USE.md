# ‚úÖ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!

## üéâ –í—Å—ë –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ –ü—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã:

1. **‚ùå "Failed to fetch"** ‚Üí **‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û!**
   - –ü—Ä–∏—á–∏–Ω–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç API
   - –†–µ—à–µ–Ω–∏–µ: Nginx –ø—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **API4 (–ø–æ—Ä—Ç 8084)**

2. **‚ùå "502 Bad Gateway"** ‚Üí **‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û!**
   - –ü—Ä–∏—á–∏–Ω–∞: –ü—Ä–æ–∫—Å–∏ —Å–º–æ—Ç—Ä–µ–ª –Ω–∞ API5 (Shop Parser)
   - –†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ **API4 (Battle Logs)**

3. **‚ùå –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ** ‚Üí **‚úÖ –£–î–ê–õ–ï–ù–´!**
   - –í—Å–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ —É–±—Ä–∞–Ω—ã –∏–∑ –¥–∞—à–±–æ—Ä–¥–æ–≤
   - –¢–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API4

4. **‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö** ‚Üí **‚úÖ –ê–î–ê–ü–¢–ò–†–û–í–ê–ù–û!**
   - –î–∞—à–±–æ—Ä–¥—ã –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ —Ñ–æ—Ä–º–∞—Ç API4
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

---

## üîå –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
–ë—Ä–∞—É–∑–µ—Ä
  ‚Üì
http://localhost:14488/api/...
  ‚Üì
Nginx (wg_visualization)
  ‚Üì
http://host.docker.internal:8084/...
  ‚Üì
API4 (Battle Logs) ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
```

---

## üöÄ –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã

–û—Ç–∫—Ä–æ–π—Ç–µ: **http://localhost:14488**

### ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

1. **üî• Analytics Heatmap** ‚Üí `/analytics-heatmap.html`
   - –ò—Å—Ç–æ—á–Ω–∏–∫–∏: Analytics, PvE, PvP
   - Endpoints: ‚úÖ —Ä–∞–±–æ—Ç–∞—é—Ç
   - –î–∞–Ω–Ω—ã–µ: ‚úÖ 27 —Ç–æ—á–µ–∫

2. **üó∫Ô∏è Clan Control** ‚Üí `/analytics-clan-control.html`
   - Endpoint: ‚úÖ /analytics/map/clan-control
   - –î–∞–Ω–Ω—ã–µ: ‚úÖ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–ª–∞–Ω–∞–º

3. **‚ö†Ô∏è Churn Prediction** ‚Üí `/analytics-churn.html`
   - Endpoint: ‚úÖ /analytics/predictions/churn
   - –î–∞–Ω–Ω—ã–µ: ‚úÖ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã (churn_score ‚Üí %)

4. **üó∫Ô∏è Heatmap (—Ä–µ–¥–∞–∫—Ç–æ—Ä)** ‚Üí `/heatmap.html`
   - –õ–æ–∫–∞—Ü–∏–∏: ‚úÖ 3 –∫—É–ø–æ–ª–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

---

## ‚ö†Ô∏è –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ endpoints (TODO):

–≠—Ç–∏ –¥–∞—à–±–æ—Ä–¥—ã –ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å API (endpoints –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ API4):

- **‚è∞ Peak Hours** ‚Äî –Ω–µ—Ç `/analytics/time/peak-hours`
- **‚öîÔ∏è PvP ELO** ‚Äî –Ω–µ—Ç `/analytics/pvp/elo` (–µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `/analytics/pve/elo`)
- **üë§ Players** ‚Äî –Ω—É–∂–Ω—ã endpoints –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
- **ü§ñ Antibot** ‚Äî –Ω—É–∂–Ω—ã endpoints –∞–Ω—Ç–∏–±–æ—Ç–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

### 1. Analytics Heatmap (—Ä–∞–±–æ—Ç–∞–µ—Ç!)

```bash
# –û—Ç–∫—Ä—ã—Ç—å
open http://localhost:14488/analytics-heatmap.html

# –í –±—Ä–∞—É–∑–µ—Ä–µ:
1. –í—ã–±—Ä–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫: "üìä Analytics Heatmap"
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—ã (–ª—é–±—ã–µ)
3. –ù–∞–∂–∞—Ç—å "üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å"
4. –î–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è ~27 —Ç–æ—á–µ–∫ –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ!
```

### 2. Clan Control (—Ä–∞–±–æ—Ç–∞–µ—Ç!)

```bash
# –û—Ç–∫—Ä—ã—Ç—å
open http://localhost:14488/analytics-clan-control.html

# –í –±—Ä–∞—É–∑–µ—Ä–µ:
1. –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥: 30 –¥–Ω–µ–π
2. –ù–∞–∂–∞—Ç—å "üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"
3. –ü–æ—è–≤—è—Ç—Å—è –∫–ª–∞–Ω—ã —Å % –∫–æ–Ω—Ç—Ä–æ–ª—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π!
```

### 3. Churn Prediction (—Ä–∞–±–æ—Ç–∞–µ—Ç!)

```bash
# –û—Ç–∫—Ä—ã—Ç—å
open http://localhost:14488/analytics-churn.html

# –í –±—Ä–∞—É–∑–µ—Ä–µ:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—ã
2. –í—ã–±—Ä–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: "–í—ã—Å–æ–∫–∏–π (>70%)"
3. –ù–∞–∂–∞—Ç—å "üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å"
4. –ü–æ—è–≤–∏—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –∏–≥—Ä–æ–∫–æ–≤ –≤ –≥—Ä—É–ø–ø–µ —Ä–∏—Å–∫–∞!
```

---

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints API4

```
‚úÖ /analytics/map/heatmap
‚úÖ /analytics/map/clan-control
‚úÖ /analytics/map/pvp-hotspots
‚úÖ /analytics/pve/top-locations
‚úÖ /analytics/predictions/churn
‚úÖ /analytics/meta/professions
‚úÖ /analytics/playstyle/clusters/stats
‚úÖ /analytics/pve/elo
```

**Swagger:** http://localhost:14488/api/docs

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API

```bash
# –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API4
curl http://localhost:8084/analytics/map/heatmap | jq 'length'
# –í—ã–≤–æ–¥: 27

# –ß–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
curl http://localhost:14488/api/analytics/map/heatmap | jq 'length'  
# –í—ã–≤–æ–¥: 27

# –û–±–µ –∫–æ–º–∞–Ω–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç = –ø—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç! ‚úÖ
```

---

## üìù –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö API4

### Heatmap
```json
[
  {"loc": [-8, -4], "battles": 359},
  {"loc": [6, 10], "battles": 285}
]
```

### Clan Control
```json
[
  {
    "loc": [-8, -4],
    "dominant_clan": "COUNCIL OF ISLE DE MUERTO",
    "battles": 139
  }
]
```

### Churn Prediction
```json
[
  {
    "login": "VAGINALNYI SPAZM",
    "battles_first_half": 30,
    "battles_second_half": 0,
    "churn_score": 1.0,
    "days_since_last_battle": 19,
    "priority": "HIGH"
  }
]
```

---

## üéØ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### 1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –¥–∞—à–±–æ—Ä–¥—ã ‚úÖ
```
http://localhost:14488/analytics-heatmap.html
http://localhost:14488/analytics-clan-control.html
http://localhost:14488/analytics-churn.html
```

### 2. –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoints

–°–ø–∏—Å–æ–∫ –Ω—É–∂–Ω—ã—Ö endpoints –≤ —Ñ–∞–π–ª–µ: `API_ENDPOINTS_NEEDED.md`

---

## üöÄ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

| –î–∞—à–±–æ—Ä–¥ | API Endpoint | –°—Ç–∞—Ç—É—Å |
|---------|--------------|--------|
| Analytics Heatmap | /analytics/map/heatmap | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |
| Clan Control | /analytics/map/clan-control | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |
| Churn Prediction | /analytics/predictions/churn | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |
| Heatmap (—Ä–µ–¥–∞–∫—Ç–æ—Ä) | /data/locations.json | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |
| Peak Hours | /analytics/time/peak-hours | ‚ö†Ô∏è –ù–µ—Ç endpoint |
| PvP ELO | /analytics/pvp/elo | ‚ö†Ô∏è –ù–µ—Ç endpoint |
| Players | /player/search | ‚ö†Ô∏è –ù–µ—Ç endpoint |
| Antibot | /antibot/stream | ‚ö†Ô∏è –ù–µ—Ç endpoint |
| ML Clusters | /ml/clusters/stats | ‚ö†Ô∏è –ù–µ—Ç endpoint |

---

## ‚ú® –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

### –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:

```
http://localhost:14488/analytics-heatmap.html
```

**–®–∞–≥–∏:**
1. –û—Å—Ç–∞–≤—å—Ç–µ –¥–∞—Ç—ã –∫–∞–∫ –µ—Å—Ç—å
2. –í—ã–±–µ—Ä–∏—Ç–µ "üìä Analytics Heatmap"
3. –ù–∞–∂–º–∏—Ç–µ "üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å"
4. **–ß–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—è–≤—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –Ω–∞ –∫–∞—Ä—Ç–µ!** üéâ

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü–æ—Ä—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 14488  
**–ü–æ—Ä—Ç API4:** 8084  
**Nginx –ø—Ä–æ–∫—Å–∏:** `/api/*` ‚Üí `http://host.docker.internal:8084/`  
**–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ:** —É–¥–∞–ª–µ–Ω—ã  

---

**–ì–û–¢–û–í–û!** üöÄ –¢—Ä–∏ –¥–∞—à–±–æ—Ä–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ API4!

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏—Ö –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å: http://localhost:14488









