# üì° API 5 - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö endpoints

**–í—Å–µ 10 API endpoints —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤**

---

## üè• HEALTH & SERVICE (3 endpoints)

### 1. GET /healthz
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl http://localhost:8085/healthz
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "service": "API 5 - Shop Parser"
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** 
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω
- Healthcheck –≤ Docker
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus)

---

### 2. GET /shop/health
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª—è –º–∞–≥–∞–∑–∏–Ω–∞

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl http://localhost:8085/shop/health
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "service": "Shop Parser Module"
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –º–∞–≥–∞–∑–∏–Ω–∞
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

---

### 3. GET /db/health
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL –ë–î

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl http://localhost:8085/db/health
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "database": "connected"
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

---

## üì¶ ITEMS (3 endpoints)

### 4. GET /items/list
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

**–ó–∞–ø—Ä–æ—Å 1: –í—Å–µ —Ç–æ–≤–∞—Ä—ã**
```bash
curl "http://localhost:8085/items/list?page=1&limit=10"
```

**–ó–∞–ø—Ä–æ—Å 2: –¢–æ–ª—å–∫–æ Moscow**
```bash
curl "http://localhost:8085/items/list?shop_code=moscow&page=1&limit=5"
```

**–ó–∞–ø—Ä–æ—Å 3: –¢–æ–ª—å–∫–æ Oasis**
```bash
curl "http://localhost:8085/items/list?shop_code=oasis&limit=20"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "items": [
    {
      "id": 79469641,
      "txt": "Butterfly knife",
      "price": 4.0,
      "current_quality": 125,
      "max_quality": 125,
      "shop_id": 1,
      "template_id": 42,
      "owner": null
    },
    {
      "id": 79470735,
      "txt": "Beretta 92/93",
      "price": 22.0,
      "current_quality": 95,
      "max_quality": 95,
      "shop_id": 1,
      "template_id": 43,
      "owner": "PlayerX"
    },
    ... (–µ—â—ë 8 —Ç–æ–≤–∞—Ä–æ–≤)
  ],
  "total": 10,
  "page": 1,
  "limit": 10
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `shop_code` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –º–∞–≥–∞–∑–∏–Ω—É (moscow/oasis/neva)
- `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Å 1)
- `limit` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (max 1000)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
- –ü–æ–∏—Å–∫ –ø–æ –º–∞–≥–∞–∑–∏–Ω—É
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞

---

### 5. GET /items/{id}
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–≤–∞—Ä–µ

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl http://localhost:8085/items/79469641
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 79469641,
  "txt": "Butterfly knife",
  "price": 4.0,
  "current_quality": 125,
  "max_quality": 125,
  "shop_id": 1,
  "template_id": 42,
  "owner": null
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω—ã
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### 6. GET /items/search (TODO)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º

**–ó–∞–ø—Ä–æ—Å (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ):**
```bash
curl "http://localhost:8085/items/search?txt=knife&price_min=5&price_max=50"
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ü–µ–Ω–µ
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—á–µ—Å—Ç–≤—É

---

## üì∏ SNAPSHOTS (2 endpoints)

### 7. GET /snapshots/list
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–Ω–∏–º–∫–æ–≤ –º–∞–≥–∞–∑–∏–Ω–æ–≤

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl "http://localhost:8085/snapshots/list"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "snapshots": [
    {
      "id": 5,
      "shop_id": 1,
      "created_at": "2025-10-11T15:30:00",
      "items_count": 1847,
      "worker_name": "moscow_worker"
    },
    {
      "id": 4,
      "shop_id": 1,
      "created_at": "2025-10-11T14:30:00",
      "items_count": 1835,
      "worker_name": "moscow_worker"
    },
    {
      "id": 3,
      "shop_id": 2,
      "created_at": "2025-10-11T15:30:15",
      "items_count": 1652,
      "worker_name": "oasis_worker"
    }
  ],
  "total": 3
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Å–Ω–∏–º–∫–æ–≤
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —á–∞—Å—Ç–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –í—ã–±–æ—Ä —Å–Ω–∏–º–∫–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

---

### 8. GET /snapshots/latest
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl "http://localhost:8085/snapshots/latest?shop_code=moscow"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 5,
  "shop_id": 1,
  "created_at": "2025-10-11T15:30:00",
  "items_count": 1847,
  "worker_name": "moscow_worker"
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã –≤–æ—Ä–∫–µ—Ä–æ–≤

---

## üëë ADMIN (2 endpoints)

### 9. POST /admin/snapshot/trigger
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞ –≤—Ä—É—á–Ω—É—é (–±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è —á–∞—Å–∞)

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST "http://localhost:8085/admin/snapshot/trigger?shop_code=moscow"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "triggered",
  "shop_code": "moscow",
  "message": "Snapshot creation started"
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

### 10. GET /admin/bots/status
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –±–æ—Ç–æ–≤-–ø–∞—Ä—Å–µ—Ä–æ–≤ (moscow, oasis, neva)

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl http://localhost:8085/admin/bots/status
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "bots": [
    {
      "shop_code": "moscow",
      "bot_login": "Sova",
      "authenticated": true,
      "session_id": "Sova...",
      "last_activity": "2025-10-11T15:45:30"
    },
    {
      "shop_code": "oasis",
      "bot_login": "Sova",
      "authenticated": true,
      "session_id": "Sova...",
      "last_activity": "2025-10-11T15:45:28"
    },
    {
      "shop_code": "neva",
      "bot_login": "Sova",
      "authenticated": false,
      "session_id": null,
      "last_activity": null
    }
  ]
}
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞
- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ID —Å–µ—Å—Å–∏–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã –≤–æ—Ä–∫–µ—Ä–æ–≤
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ keep-alive –ø–∏–Ω–≥–æ–≤

---

## üìö SWAGGER UI

### 11. GET /docs
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**–û—Ç–∫—Ä—ã—Ç—å:**
```bash
open http://localhost:8085/docs
```

**–ß—Ç–æ –º–æ–∂–Ω–æ:**
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ endpoints
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- ‚úÖ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–∫–∞—á–∞—Ç—å OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é

---

## üéØ –°–¶–ï–ù–ê–†–ò–ò –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:8085/healthz

# –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î
curl http://localhost:8085/db/health

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤
curl http://localhost:8085/admin/bots/status
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–Ω—è—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–æ–∑–¥–∞—Ç—å —Å–Ω–∏–º–æ–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

```bash
# –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–∏–º–æ–∫ Moscow
curl -X POST "http://localhost:8085/admin/snapshot/trigger?shop_code=moscow"

# –®–∞–≥ 2: –ü–æ–¥–æ–∂–¥–∞—Ç—å 10-15 –º–∏–Ω—É—Ç

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫
curl "http://localhost:8085/snapshots/latest?shop_code=moscow"
# ‚Üí items_count: 1847

# –®–∞–≥ 4: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–≤–∞—Ä—ã
curl "http://localhost:8085/items/list?shop_code=moscow&limit=10"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–Ω–∏–º–æ–∫ —Å–æ–∑–¥–∞–Ω, —Ç–æ–≤–∞—Ä—ã –≤ –ë–î

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# –ö–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å:
while true; do
    curl -s http://localhost:8085/snapshots/latest?shop_code=moscow | \
        jq '{id, items_count, created_at}'
    sleep 600
done
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–∏–º –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ù–∞–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä

```bash
# –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ Moscow
curl "http://localhost:8085/items/list?shop_code=moscow&limit=100" | \
    jq '.items[] | select(.txt | contains("knife"))'

# –®–∞–≥ 2: –í–∑—è—Ç—å ID –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏
curl http://localhost:8085/items/79469641
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ

---

## üìä –ü–†–ò–ú–ï–†–´ –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–•

### –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–Ω–∏–º–∫–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

**GET /items/list?shop_code=moscow&limit=5**
```json
{
  "items": [
    {"id": 100001, "txt": "Butterfly knife", "price": 4.0, "quality": 125},
    {"id": 100002, "txt": "Combat knife", "price": 8.0, "quality": 150},
    {"id": 200001, "txt": "Beretta 92/93", "price": 22.0, "quality": 95},
    {"id": 300001, "txt": "AK-47", "price": 85.0, "quality": 120},
    {"id": 400001, "txt": "Blaster Rifle", "price": 66.0, "quality": 50}
  ],
  "total": 5,
  "page": 1
}
```

**GET /snapshots/latest?shop_code=moscow**
```json
{
  "id": 1,
  "shop_id": 1,
  "created_at": "2025-10-11T15:30:00",
  "items_count": 1847,
  "worker_name": "moscow_worker"
}
```

**GET /admin/bots/status**
```json
{
  "bots": [
    {
      "shop_code": "moscow",
      "bot_login": "Sova",
      "authenticated": true,
      "last_activity": "2025-10-11T15:45:30"
    },
    {
      "shop_code": "oasis",
      "bot_login": "Sova",
      "authenticated": true,
      "last_activity": "2025-10-11T15:45:28"
    },
    {
      "shop_code": "neva",
      "bot_login": "Sova",
      "authenticated": true,
      "last_activity": "2025-10-11T15:45:32"
    }
  ]
}
```

---

## üîß –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl -s http://localhost:8085/healthz | jq

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl -s http://localhost:8085/healthz && \
curl -s http://localhost:8085/db/health && \
curl -s http://localhost:8085/admin/bots/status | jq
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤
```bash
# –¢–æ–ø 10 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö –≤ Moscow
curl -s "http://localhost:8085/items/list?shop_code=moscow&limit=1000" | \
    jq '.items | sort_by(.price) | reverse | .[0:10] | .[] | {txt, price}'

# –¢–æ–ø 10 –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
curl -s "http://localhost:8085/items/list?shop_code=moscow&limit=1000" | \
    jq '.items | sort_by(.current_quality) | reverse | .[0:10] | .[] | {txt, quality: .current_quality}'
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–Ω–∏–º–∫–æ–≤
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–Ω–∏–º–∫–∏ –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
for shop in moscow oasis neva; do
    echo "=== $shop ==="
    curl -s "http://localhost:8085/snapshots/latest?shop_code=$shop" | jq
    echo ""
done
```

---

## üéØ –ò–¢–û–ì–û: 10 ENDPOINTS

| ‚Ññ | Endpoint | –ú–µ—Ç–æ–¥ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|---|----------|-------|------------|
| 1 | `/healthz` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ |
| 2 | `/shop/health` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª—è |
| 3 | `/db/health` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î |
| 4 | `/items/list` | GET | –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ (—Ñ–∏–ª—å—Ç—Ä—ã, –ø–∞–≥–∏–Ω–∞—Ü–∏—è) |
| 5 | `/items/{id}` | GET | –î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞ |
| 6 | `/items/search` | GET | –ü–æ–∏—Å–∫ (TODO) |
| 7 | `/snapshots/list` | GET | –°–ø–∏—Å–æ–∫ —Å–Ω–∏–º–∫–æ–≤ |
| 8 | `/snapshots/latest` | GET | –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫ –º–∞–≥–∞–∑–∏–Ω–∞ |
| 9 | `/admin/snapshot/trigger` | POST | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–∏–º–æ–∫ –≤—Ä—É—á–Ω—É—é |
| 10 | `/admin/bots/status` | GET | –°—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤ |

**+ Swagger UI:** `/docs` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üöÄ –ë–´–°–¢–†–´–ô –¢–ï–°–¢

### –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
cd /Users/ii/Documents/code/WG_HUB/wg_client/api_5
./test_api_endpoints.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ 10 endpoints
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã
- –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

---

**–í—Å–µ endpoints –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** ‚úÖ







