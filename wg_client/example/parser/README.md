# TZB Battle Parser

Парсер для анализа файлов боевых логов TZB (Техноложка).

## Основные файлы

### Парсер
- `battle_parser.py` - основной модуль парсера
- `main.py` - CLI интерфейс для парсера
- `dedupe_tzb.py` - утилита для удаления дублированных блоков BATTLE

### Документация
- `MAIN.md` - полная документация проекта
- `README.md` - этот файл

### Тестовые скрипты
- `test_kills_parser.py` - тест подсчёта убийств
- `test_healing.py` - тест парсинга HP значений
- `test_attributes.py` - тест словаря атрибутов
- `test_battle_parser_damage.py` - тест анализа урона по ходам
- `test_stance_analysis.py` - тест анализа смены стоек
- `test_interventions.py` - тест анализа вмешательств в бой

### Утилиты анализа урона
- `analyze_damage_by_turns.py` - анализ урона по ходам
- `analyze_damage_corrected.py` - исправленная версия анализа
- `analyze_damage_detailed.py` - детальный анализ урона
- `analyze_damage_final.py` - финальная версия анализа

## Использование

```bash
# Основное использование
python3 main.py path/to/battle.tzb

# Тестирование
python3 test_kills_parser.py
python3 test_battle_parser_damage.py

# Анализ урона
python3 analyze_damage_by_turns.py path/to/battle.tzb
```

## Возможности

- ✅ Парсинг участников боя (игроки и монстры)
- ✅ Подсчёт убийств с точной атрибуцией
- ✅ Анализ лута и ресурсов
- ✅ Детальный анализ урона (обычный, критический, бронебойный)
- ✅ Специальные эффекты (отравление, паралич, паника и др.)
- ✅ Анализ вмешательств в бой
- ✅ Смена стоек и побеги из боя
- ✅ Автоматическая дедупликация XML
- ✅ Оптимизированный JSON вывод

## Форматы урона

- `HP="0:60"` - обычный урон: 60
- `HP="1:46"` - критический урон: 46
- `HP="2:31"` - бронебойный урон: 31
- `HP="0:18:N4"` - обычный урон: 18 + паника: 4

## JSON Schema

Подробное описание JSON схемы см. в `MAIN.md`.
